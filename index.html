<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Noise Normulator - Harmonize Your Hood</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #1a202c; /* Dark background for a modern feel */
            color: #e2e8f0; /* Light text for contrast */
        }
        nav {
            background-color: #2d3748; /* Slightly lighter dark for nav */
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        nav a {
            transition: all 0.3s ease;
            border-bottom: 2px solid transparent;
        }
        nav a:hover, nav a.active-nav {
            color: #63b3ed; /* Light blue for hover/active */
            border-bottom-color: #63b3ed;
        }
        .section-title {
            font-family: 'Press Start 2P', cursive;
            color: #9f7aea; /* Purple for gamified titles */
            text-shadow: 2px 2px #000;
        }
        .card {
            background-color: #2d3748; /* Card background */
            border: 1px solid #4a5568; /* Card border */
            box-shadow: 0 10px 15px -3px rgba(0,0,0,0.2), 0 4px 6px -2px rgba(0,0,0,0.1);
        }
        .accordion-button {
            background-color: #4a5568; /* Accordion button background */
            transition: background-color 0.3s ease;
        }
        .accordion-button:hover {
            background-color: #63b3ed; /* Lighter blue on hover */
        }
        .accordion-content {
            background-color: #2d3748; /* Slightly lighter than card for depth */
            border-top: 1px solid #4a5568;
        }
        .slider-thumb::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            background: #63b3ed;
            cursor: pointer;
            border-radius: 50%;
            border: 2px solid #1a202c;
        }
        .slider-thumb::-moz-range-thumb {
            width: 20px;
            height: 20px;
            background: #63b3ed;
            cursor: pointer;
            border-radius: 50%;
            border: 2px solid #1a202c;
        }
        .checkbox-group label, .radio-group label {
            background-color: #4a5568;
            transition: background-color 0.3s ease, transform 0.2s ease;
            border: 1px solid #718096;
        }
        .checkbox-group input:checked + span, .radio-group input:checked + span {
            background-color: #63b3ed;
            color: #1a202c;
            font-weight: 600;
        }
         .checkbox-group label:hover, .radio-group label:hover {
            background-color: #718096;
            transform: translateY(-2px);
        }

        input[type="text"], input[type="time"], textarea, select {
            background-color: #1a202c;
            border: 1px solid #4a5568;
            color: #e2e8f0;
        }
        input[type="text"]:focus, input[type="time"]:focus, textarea:focus, select:focus {
            border-color: #63b3ed;
            box-shadow: 0 0 0 3px rgba(99, 179, 237, 0.5);
            outline: none;
        }
        button.primary-button {
            background-color: #63b3ed; /* Primary action blue */
            color: #1a202c;
            font-weight: bold;
            transition: background-color 0.3s ease, transform 0.2s ease;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }
        button.primary-button:hover {
            background-color: #90cdf4; /* Lighter blue on hover */
            transform: translateY(-2px);
        }
        button.secondary-button {
            background-color: #4a5568;
            color: #e2e8f0;
        }
        button.secondary-button:hover {
            background-color: #718096;
        }

        /* Harmony/Conflict Colors */
        .harmony-high { color: #48bb78; } /* Green */
        .harmony-mid { color: #f6e05e; } /* Yellow */
        .harmony-low { color: #f56565; } /* Red */

        .importance-high { border-left: 4px solid #f56565; }
        .importance-mid { border-left: 4px solid #f6e05e; }
        .importance-low { border-left: 4px solid #48bb78; }

        /* Meter styling */
        .harmony-meter-container {
            width: 100%;
            background-color: #4a5568;
            border-radius: 0.5rem;
            overflow: hidden;
            height: 30px;
            border: 2px solid #718096;
        }
        .harmony-meter-bar {
            height: 100%;
            background: linear-gradient(90deg, #f56565 0%, #f6e05e 50%, #48bb78 100%);
            transition: width 0.5s ease-in-out;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #1a202c;
        }
        .sound-source-icon {
            font-size: 1.5rem; /* Adjust as needed */
            margin-right: 0.5rem;
        }
    </style>
</head>
<body class="min-h-screen">
    <nav class="p-4 flex justify-around items-center sticky top-0 z-50">
        <a href="#" onclick="showSection('profile', this)" class="text-lg font-semibold p-2 active-nav">Your Preferences</a>
        <a href="#" onclick="showSection('harmonize', this)" class="text-lg font-semibold p-2">Harmonize</a>
        <a href="#" onclick="showSection('complaints', this)" class="text-lg font-semibold p-2">Report Concern</a>
    </nav>

    <main class="p-4 md:p-8">
        <section id="profile" class="active space-y-8">
            <h2 class="text-3xl md:text-4xl font-bold text-center section-title mb-8">Your Sound Profile</h2>

            <div class="card rounded-lg overflow-hidden">
                <button onclick="toggleAccordion('accordion-sensitivity')" class="accordion-button w-full text-left p-4 font-semibold text-xl flex justify-between items-center">
                    <span>🔊 Your Sound Sensitivity</span>
                    <span class="accordion-icon transform transition-transform duration-300 ">▼</span>
                </button>
                <div id="accordion-sensitivity" class="accordion-content p-6 space-y-6 hidden">
                    <div>
                        <label for="noise-sensitivity" class="block text-sm font-medium text-gray-300 mb-1">How would you describe your general sensitivity to noise?</label>
                        <input type="range" id="noise-sensitivity" min="1" max="5" value="3" class="w-full h-3 bg-gray-700 rounded-lg appearance-none cursor-pointer slider-thumb">
                        <div class="flex justify-between text-xs text-gray-400 mt-1">
                            <span>Very Low</span><span>Low</span><span>Medium</span><span>High</span><span>Very High</span>
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-1">What time of day are you most sensitive to noise?</label>
                        <div class="checkbox-group grid grid-cols-2 sm:grid-cols-4 gap-2">
                            <label class="p-3 rounded-md cursor-pointer text-center"><input type="checkbox" class="hidden" name="sensitivity-time" value="morning"> <span class="block p-2 rounded-md">Morning</span></label>
                            <label class="p-3 rounded-md cursor-pointer text-center"><input type="checkbox" class="hidden" name="sensitivity-time" value="afternoon"> <span class="block p-2 rounded-md">Afternoon</span></label>
                            <label class="p-3 rounded-md cursor-pointer text-center"><input type="checkbox" class="hidden" name="sensitivity-time" value="evening"> <span class="block p-2 rounded-md">Evening</span></label>
                            <label class="p-3 rounded-md cursor-pointer text-center"><input type="checkbox" class="hidden" name="sensitivity-time" value="night"> <span class="block p-2 rounded-md">Night</span></label>
                        </div>
                    </div>
                    <div>
                        <label for="critical-quiet-times" class="block text-sm font-medium text-gray-300 mb-1">What specific times are crucial for your quiet? (e.g., work calls 2-4pm, baby's nap 1-3pm)</label>
                        <input type="text" id="critical-quiet-times" placeholder="e.g., Mon 10am-12pm for meetings" class="w-full p-2 rounded-md">
                    </div>
                     <div>
                        <label class="block text-sm font-medium text-gray-300 mb-1">Which days are most critical for quiet?</label>
                        <div class="checkbox-group grid grid-cols-2 sm:grid-cols-3 gap-2">
                            <label class="p-3 rounded-md cursor-pointer text-center"><input type="checkbox" class="hidden" name="critical-days" value="weekdays"> <span class="block p-2 rounded-md">Weekdays</span></label>
                            <label class="p-3 rounded-md cursor-pointer text-center"><input type="checkbox" class="hidden" name="critical-days" value="weekends"> <span class="block p-2 rounded-md">Weekends</span></label>
                            <label class="p-3 rounded-md cursor-pointer text-center"><input type="checkbox" class="hidden" name="critical-days" value="specific"> <span class="block p-2 rounded-md">Specific Days (add below)</span></label>
                        </div>
                        <input type="text" id="specific-critical-days" placeholder="e.g., Sundays" class="w-full p-2 rounded-md mt-2 hidden">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-1">What types of noise from neighbors bother you most?</label>
                        <div class="checkbox-group grid grid-cols-2 md:grid-cols-3 gap-2">
                            <label class="p-3 rounded-md cursor-pointer text-center"><input type="checkbox" name="bothering-noises"><span class="block p-2 rounded-md">Loud Music/TV</span></label>
                            <label class="p-3 rounded-md cursor-pointer text-center"><input type="checkbox" name="bothering-noises"><span class="block p-2 rounded-md">Talking/Shouting</span></label>
                            <label class="p-3 rounded-md cursor-pointer text-center"><input type="checkbox" name="bothering-noises"><span class="block p-2 rounded-md">Footsteps/Impact</span></label>
                            <label class="p-3 rounded-md cursor-pointer text-center"><input type="checkbox" name="bothering-noises"><span class="block p-2 rounded-md">Construction/DIY</span></label>
                            <label class="p-3 rounded-md cursor-pointer text-center"><input type="checkbox" name="bothering-noises"><span class="block p-2 rounded-md">Pets (barking, etc.)</span></label>
                            <label class="p-3 rounded-md cursor-pointer text-center"><input type="checkbox" name="bothering-noises"><span class="block p-2 rounded-md">Children Playing</span></label>
                            <label class="p-3 rounded-md cursor-pointer text-center"><input type="checkbox" name="bothering-noises"><span class="block p-2 rounded-md">Parties/Gatherings</span></label>
                            <label class="p-3 rounded-md cursor-pointer text-center"><input type="checkbox" name="bothering-noises"><span class="block p-2 rounded-md">Outdoor Equipment</span></label>
                            <label class="p-3 rounded-md cursor-pointer text-center"><input type="checkbox" name="bothering-noises"><span class="block p-2 rounded-md">Other</span></label>
                        </div>
                        <textarea id="other-bothering-noise" placeholder="Specify other noises..." class="w-full p-2 rounded-md mt-2 hidden" rows="2"></textarea>
                    </div>
                </div>
            </div>

            <div class="card rounded-lg overflow-hidden">
                <button onclick="toggleAccordion('accordion-sound-output')" class="accordion-button w-full text-left p-4 font-semibold text-xl flex justify-between items-center">
                    <span>🏡 Your Household's Sound Output</span>
                    <span class="accordion-icon transform transition-transform duration-300 ">▼</span>
                </button>
                <div id="accordion-sound-output" class="accordion-content p-6 space-y-6 hidden">
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-1">Primary sources of noise from your household?</label>
                        <div class="checkbox-group grid grid-cols-2 md:grid-cols-3 gap-2">
                            <label class="p-3 rounded-md cursor-pointer text-center"><input type="checkbox" name="household-noises" value="tv-music"><span class="block p-2 rounded-md">TV/Music</span></label>
                            <label class="p-3 rounded-md cursor-pointer text-center"><input type="checkbox" name="household-noises" value="instruments"><span class="block p-2 rounded-md">Instruments</span></label>
                            <label class="p-3 rounded-md cursor-pointer text-center"><input type="checkbox" name="household-noises" value="children"><span class="block p-2 rounded-md">Children Playing</span></label>
                            <label class="p-3 rounded-md cursor-pointer text-center"><input type="checkbox" name="household-noises" value="pets"><span class="block p-2 rounded-md">Pets</span></label>
                            <label class="p-3 rounded-md cursor-pointer text-center"><input type="checkbox" name="household-noises" value="hobbies"><span class="block p-2 rounded-md">Hobbies (DIY, etc.)</span></label>
                            <label class="p-3 rounded-md cursor-pointer text-center"><input type="checkbox" name="household-noises" value="gatherings"><span class="block p-2 rounded-md">Gatherings</span></label>
                            <label class="p-3 rounded-md cursor-pointer text-center"><input type="checkbox" name="household-noises" value="appliances"><span class="block p-2 rounded-md">Appliances</span></label>
                            <label class="p-3 rounded-md cursor-pointer text-center"><input type="checkbox" name="household-noises" value="exercise"><span class="block p-2 rounded-md">Exercise Equip.</span></label>
                            <label class="p-3 rounded-md cursor-pointer text-center"><input type="checkbox" name="household-noises" value="other"><span class="block p-2 rounded-md">Other</span></label>
                        </div>
                        <div id="household-noise-details" class="mt-4 space-y-4">
                            </div>
                    </div>
                </div>
            </div>

            <div class="card rounded-lg overflow-hidden">
                <button onclick="toggleAccordion('accordion-management')" class="accordion-button w-full text-left p-4 font-semibold text-xl flex justify-between items-center">
                    <span>🤝 Sound Management & Flexibility</span>
                    <span class="accordion-icon transform transition-transform duration-300 ">▼</span>
                </button>
                <div id="accordion-management" class="accordion-content p-6 space-y-6 hidden">
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-1">Steps you currently take to minimize your noise?</label>
                        <div class="checkbox-group grid grid-cols-2 md:grid-cols-3 gap-2">
                             <label class="p-3 rounded-md cursor-pointer text-center"><input type="checkbox" name="management-steps"><span class="block p-2 rounded-md">Soundproofing</span></label>
                             <label class="p-3 rounded-md cursor-pointer text-center"><input type="checkbox" name="management-steps"><span class="block p-2 rounded-md">Scheduling</span></label>
                             <label class="p-3 rounded-md cursor-pointer text-center"><input type="checkbox" name="management-steps"><span class="block p-2 rounded-md">Headphones</span></label>
                             <label class="p-3 rounded-md cursor-pointer text-center"><input type="checkbox" name="management-steps"><span class="block p-2 rounded-md">Pet Training</span></label>
                             <label class="p-3 rounded-md cursor-pointer text-center"><input type="checkbox" name="management-steps"><span class="block p-2 rounded-md">Rugs/Curtains</span></label>
                             <label class="p-3 rounded-md cursor-pointer text-center"><input type="checkbox" name="management-steps"><span class="block p-2 rounded-md">Other</span></label>
                        </div>
                    </div>
                    <div>
                        <label for="willingness-adjust-timing" class="block text-sm font-medium text-gray-300 mb-1">How willing are you to adjust timing of noisy activities?</label>
                        <input type="range" id="willingness-adjust-timing" min="1" max="5" value="3" class="w-full h-3 bg-gray-700 rounded-lg appearance-none cursor-pointer slider-thumb">
                        <div class="flex justify-between text-xs text-gray-400 mt-1">
                            <span>Not Willing</span><span></span><span>Neutral</span><span></span><span>Very Willing</span>
                        </div>
                    </div>
                    <div>
                        <label for="willingness-sound-dampening" class="block text-sm font-medium text-gray-300 mb-1">How willing to invest in sound-dampening (e.g., rugs)?</label>
                        <input type="range" id="willingness-sound-dampening" min="1" max="5" value="2" class="w-full h-3 bg-gray-700 rounded-lg appearance-none cursor-pointer slider-thumb">
                         <div class="flex justify-between text-xs text-gray-400 mt-1">
                            <span>Not Willing</span><span></span><span>Neutral</span><span></span><span>Very Willing</span>
                        </div>
                    </div>
                    <div>
                        <label for="unavoidable-noises" class="block text-sm font-medium text-gray-300 mb-1">Are there noises you make that you believe are unavoidable? Please explain.</label>
                        <textarea id="unavoidable-noises" rows="3" placeholder="e.g., Baby crying, essential medical equipment" class="w-full p-2 rounded-md"></textarea>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-1">Preferred way to be approached about a noise concern?</label>
                        <div class="radio-group grid grid-cols-1 sm:grid-cols-3 gap-2">
                            <label class="p-3 rounded-md cursor-pointer text-center"><input type="radio" class="hidden" name="approach-preference" value="direct"><span class="block p-2 rounded-md">Direct Chat</span></label>
                            <label class="p-3 rounded-md cursor-pointer text-center"><input type="radio" class="hidden" name="approach-preference" value="anonymous"><span class="block p-2 rounded-md">Anonymous Note</span></label>
                            <label class="p-3 rounded-md cursor-pointer text-center"><input type="radio" class="hidden" name="approach-preference" value="hoa"><span class="block p-2 rounded-md">Via Mgmt/HOA</span></label>
                        </div>
                    </div>
                </div>
            </div>
            <button class="primary-button w-full md:w-auto px-8 py-3 text-lg rounded-lg">Save My Sound Profile</button>
        </section>

        <section id="harmonize" class="hidden space-y-8">
            <h2 class="text-3xl md:text-4xl font-bold text-center section-title mb-8">Harmonize With Your Neighbors</h2>

            <div class="card rounded-lg p-6">
                <h3 class="text-2xl font-semibold mb-2 text-yellow-400">Your Community Harmony Score</h3>
                <div class="harmony-meter-container mb-4">
                    <div id="harmony-meter-bar" class="harmony-meter-bar" style="width: 74%;">74%</div>
                </div>
                <p class="text-sm text-gray-400 mb-4">This score reflects how well your current sound habits align with community preferences. Increase it by signaling your willingness to adapt!</p>
            </div>

            <div class="card rounded-lg p-6 space-y-6">
                <h3 class="text-xl font-semibold mb-4 text-blue-400">Common Neighborhood Soundscape Goals:</h3>
                
                <div class="border border-gray-700 rounded-lg p-4 importance-high">
                    <div class="flex items-center mb-3">
                        <span class="sound-source-icon text-red-500">🎵</span>
                        <h4 class="text-lg font-semibold">Late Night Music (after 10 PM)</h4>
                    </div>
                    <p class="text-sm text-gray-400 mb-3">Many neighbors have expressed a need for quiet after 10 PM, especially on weekdays, to ensure restful sleep.</p>
                    <p class="text-sm text-gray-300 mb-1">How can you contribute to harmony?</p>
                    <div class="flex flex-col sm:flex-row gap-2 mt-2">
                        <button onclick="updateHarmony(10, this)" class="flex-1 primary-button p-2 rounded-md text-sm">✅ I can adjust (e.g., use headphones, lower volume)</button>
                        <button onclick="updateHarmony(3, this); openExplanation('music_late')" class="flex-1 secondary-button p-2 rounded-md text-sm">🤔 Partial / Explain</button>
                    </div>
                    <textarea id="explanation_music_late" class="w-full p-2 rounded-md mt-2 hidden bg-gray-800 border-gray-600" placeholder="Explain your situation or partial adjustment (shared anonymously)"></textarea>
                </div>

                <div class="border border-gray-700 rounded-lg p-4 importance-mid">
                     <div class="flex items-center mb-3">
                        <span class="sound-source-icon text-yellow-500">🐾</span>
                        <h4 class="text-lg font-semibold">Daytime Pet Noise (e.g., barking 1-3 PM)</h4>
                    </div>
                    <p class="text-sm text-gray-400 mb-3">Some residents work from home or have young children napping between 1 PM - 3 PM and are sensitive to prolonged pet noise.</p>
                    <p class="text-sm text-gray-300 mb-1">How can you contribute to harmony?</p>
                    <div class="flex flex-col sm:flex-row gap-2 mt-2">
                        <button onclick="updateHarmony(8, this)" class="flex-1 primary-button p-2 rounded-md text-sm">✅ I'll try bark-reduction / manage pet</button>
                        <button onclick="updateHarmony(2, this); openExplanation('pet_daytime')" class="flex-1 secondary-button p-2 rounded-md text-sm">🤔 Partial / Explain</button>
                    </div>
                     <textarea id="explanation_pet_daytime" class="w-full p-2 rounded-md mt-2 hidden bg-gray-800 border-gray-600" placeholder="Explain your situation (e.g., new puppy training) (shared anonymously)"></textarea>
                </div>

                 <div class="border border-gray-700 rounded-lg p-4 importance-mid">
                     <div class="flex items-center mb-3">
                        <span class="sound-source-icon text-orange-500">🛠️</span>
                        <h4 class="text-lg font-semibold">Early Morning DIY (before 9 AM weekends)</h4>
                    </div>
                    <p class="text-sm text-gray-400 mb-3">Weekend mornings are valued for rest. Loud DIY or power tool usage before 9 AM can be disruptive.</p>
                    <p class="text-sm text-gray-300 mb-1">How can you contribute to harmony?</p>
                    <div class="flex flex-col sm:flex-row gap-2 mt-2">
                        <button onclick="updateHarmony(7, this)" class="flex-1 primary-button p-2 rounded-md text-sm">✅ I can schedule DIY later</button>
                        <button onclick="updateHarmony(1, this); openExplanation('diy_morning')" class="flex-1 secondary-button p-2 rounded-md text-sm">🤔 Partial / Explain</button>
                    </div>
                     <textarea id="explanation_diy_morning" class="w-full p-2 rounded-md mt-2 hidden bg-gray-800 border-gray-600" placeholder="Explain your situation (e.g., urgent repair) (shared anonymously)"></textarea>
                </div>
                <p class="text-xs text-center text-gray-500 mt-6">Your anonymous explanations help neighbors understand different perspectives and foster empathy.</p>
            </div>
        </section>

        <section id="complaints" class="hidden space-y-8">
            <h2 class="text-3xl md:text-4xl font-bold text-center section-title mb-8">Report a Sound Concern</h2>
            <div class="card rounded-lg p-6 space-y-6 max-w-2xl mx-auto">
                <div>
                    <label for="complaint-description" class="block text-sm font-medium text-gray-300 mb-1">Describe the concern (What, When, How often?)</label>
                    <textarea id="complaint-description" rows="4" placeholder="e.g., Loud parties every Friday night until 3 AM from Apt 3B, with bass shaking walls." class="w-full p-2 rounded-md"></textarea>
                </div>
                <div>
                    <label for="complaint-source" class="block text-sm font-medium text-gray-300 mb-1">Source of the noise (Optional, if known)</label>
                    <input type="text" id="complaint-source" placeholder="e.g., Apt 3B, House #12 (blue fence)" class="w-full p-2 rounded-md">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-1">Have you tried to communicate with them directly?</label>
                    <div class="radio-group grid grid-cols-1 sm:grid-cols-3 gap-2">
                        <label class="p-3 rounded-md cursor-pointer text-center"><input type="radio" class="hidden" name="contact-attempt" value="yes"><span class="block p-2 rounded-md">Yes</span></label>
                        <label class="p-3 rounded-md cursor-pointer text-center"><input type="radio" class="hidden" name="contact-attempt" value="no"><span class="block p-2 rounded-md">No</span></label>
                        <label class="p-3 rounded-md cursor-pointer text-center"><input type="radio" class="hidden" name="contact-attempt" value="afraid"><span class="block p-2 rounded-md">I'm hesitant</span></label>
                    </div>
                </div>
                 <div>
                    <label class="block text-sm font-medium text-gray-300 mb-1">What kind of support or outcome are you seeking?</label>
                    <div class="checkbox-group grid grid-cols-1 sm:grid-cols-2 gap-2">
                        <label class="p-3 rounded-md cursor-pointer text-center"><input type="checkbox" name="support-needed"><span class="block p-2 rounded-md">Anonymous Log</span></label>
                        <label class="p-3 rounded-md cursor-pointer text-center"><input type="checkbox" name="support-needed"><span class="block p-2 rounded-md">Information for Mgmt</span></label>
                        <label class="p-3 rounded-md cursor-pointer text-center"><input type="checkbox" name="support-needed"><span class="block p-2 rounded-md">Mediation Tips</span></label>
                        <label class="p-3 rounded-md cursor-pointer text-center"><input type="checkbox" name="support-needed"><span class="block p-2 rounded-md">Formal Complaint Route</span></label>
                    </div>
                </div>
                <button class="primary-button w-full md:w-auto px-8 py-3 text-lg rounded-lg">Submit Concern Anonymously</button>
                 <p class="text-xs text-center text-gray-500 mt-4">Note: This platform facilitates communication and understanding. For urgent threats or illegal activities, please contact local authorities.</p>
            </div>
        </section>
    </main>

    <div id="messageModal" class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 hidden z-50">
        <div class="bg-gray-800 p-6 rounded-lg shadow-xl max-w-sm w-full text-center">
            <p id="modalMessageText" class="text-lg text-gray-200 mb-4"></p>
            <button onclick="closeModal()" class="primary-button px-6 py-2 rounded-md">OK</button>
        </div>
    </div>


    <script>
        let currentHarmonyScore = 74; // Initial score

        function showSection(id, navLink) {
            document.querySelectorAll('section').forEach(sec => sec.classList.add('hidden'));
            document.getElementById(id).classList.remove('hidden');

            document.querySelectorAll('nav a').forEach(link => link.classList.remove('active-nav'));
            if (navLink) {
                navLink.classList.add('active-nav');
            }
        }

        function toggleAccordion(accordionId) {
            const content = document.getElementById(accordionId);
            const icon = content.previousElementSibling.querySelector('.accordion-icon');
            content.classList.toggle('hidden');
            if (content.classList.contains('hidden')) {
                icon.style.transform = 'rotate(0deg)';
            } else {
                icon.style.transform = 'rotate(180deg)';
            }
        }

        // Show/hide specific day input
        const criticalDaysCheckboxes = document.querySelectorAll('input[name="critical-days"]');
        const specificCriticalDaysInput = document.getElementById('specific-critical-days');
        criticalDaysCheckboxes.forEach(checkbox => {
            checkbox.addEventListener('change', function() {
                if (this.value === 'specific' && this.checked) {
                    specificCriticalDaysInput.classList.remove('hidden');
                } else if (this.value === 'specific' && !this.checked) {
                     specificCriticalDaysInput.classList.add('hidden');
                }
            });
        });
        
        // Show/hide other bothering noise textarea
        const botheringNoisesCheckboxes = document.querySelectorAll('input[name="bothering-noises"]');
        const otherBotheringNoiseTextarea = document.getElementById('other-bothering-noise');
        botheringNoisesCheckboxes.forEach(checkbox => {
            checkbox.addEventListener('change', function() {
                 // Check if the "Other" checkbox specifically is checked
                const otherCheckbox = Array.from(botheringNoisesCheckboxes).find(cb => cb.nextElementSibling.textContent.trim() === 'Other');
                if (otherCheckbox && otherCheckbox.checked) {
                    otherBotheringNoiseTextarea.classList.remove('hidden');
                } else {
                    otherBotheringNoiseTextarea.classList.add('hidden');
                }
            });
        });


        // Dynamic household noise details
        const householdNoisesCheckboxes = document.querySelectorAll('input[name="household-noises"]');
        const householdNoiseDetailsContainer = document.getElementById('household-noise-details');
        const noiseDetailTemplates = {
            'tv-music': { label: 'TV/Music Details', placeholder: 'e.g., Evenings, moderate volume' },
            'instruments': { label: 'Musical Instruments Details', placeholder: 'e.g., Guitar, 6-8 PM weekdays' },
            'children': { label: 'Children Playing Details', placeholder: 'e.g., Afternoons, indoor/outdoor' },
            'pets': { label: 'Pet Noise Details', placeholder: 'e.g., Dog barks when mail arrives' },
            'hobbies': { label: 'Hobbies/DIY Details', placeholder: 'e.g., Woodworking, Sat 10am-2pm' },
            'gatherings': { label: 'Gatherings Details', placeholder: 'e.g., Monthly, ends by 11 PM' },
            'appliances': { label: 'Appliance Noise Details', placeholder: 'e.g., Washing machine, daytime runs' },
            'exercise': { label: 'Exercise Equipment Details', placeholder: 'e.g., Treadmill, morning runs' },
            'other': { label: 'Other Household Noise Details', placeholder: 'Specify noise and typical times' }
        };

        householdNoisesCheckboxes.forEach(checkbox => {
            checkbox.addEventListener('change', function() {
                updateHouseholdNoiseDetails();
            });
        });

        function updateHouseholdNoiseDetails() {
            householdNoiseDetailsContainer.innerHTML = ''; // Clear current details
            let hasDetails = false;
            householdNoisesCheckboxes.forEach(checkbox => {
                if (checkbox.checked) {
                    hasDetails = true;
                    const template = noiseDetailTemplates[checkbox.value];
                    if (template) {
                        const detailDiv = document.createElement('div');
                        detailDiv.className = 'p-3 bg-gray-700 rounded-md border border-gray-600';
                        detailDiv.innerHTML = `
                            <label for="detail-${checkbox.value}" class="block text-sm font-medium text-gray-300 mb-1">${template.label}:</label>
                            <textarea id="detail-${checkbox.value}" rows="2" placeholder="${template.placeholder}" class="w-full p-2 rounded-md bg-gray-800 border-gray-600"></textarea>
                        `;
                        householdNoiseDetailsContainer.appendChild(detailDiv);
                    }
                }
            });
             if(hasDetails) householdNoiseDetailsContainer.classList.remove('hidden'); else householdNoiseDetailsContainer.classList.add('hidden');
        }
        updateHouseholdNoiseDetails(); // Initial call


        // Harmonize Page Logic
        function updateHarmony(points, buttonElement) {
            // Prevent multiple clicks on the same positive action
            if (buttonElement.classList.contains('opacity-50')) return;

            currentHarmonyScore = Math.min(100, Math.max(0, currentHarmonyScore + points));
            const meterBar = document.getElementById('harmony-meter-bar');
            meterBar.style.width = currentHarmonyScore + '%';
            meterBar.textContent = currentHarmonyScore + '%';

            // If it's a positive contribution, disable further clicks on this specific positive button
            if (points > 0 && buttonElement.classList.contains('primary-button')) {
                 // Disable both buttons in the group to prevent toggling back and forth easily
                const parentDiv = buttonElement.parentElement;
                parentDiv.querySelectorAll('button').forEach(btn => {
                    btn.classList.add('opacity-50', 'cursor-not-allowed');
                    btn.disabled = true;
                });
                 buttonElement.classList.remove('opacity-50', 'cursor-not-allowed'); // Re-enable the clicked one slightly
                 buttonElement.disabled = false;
                 // Show a message
                 showModalMessage(`Thanks for your commitment! Your harmony score increased by ${points} points.`);
            }
        }

        function openExplanation(textareaId) {
            const textarea = document.getElementById(textareaId);
            textarea.classList.toggle('hidden');
            if (!textarea.classList.contains('hidden')) {
                textarea.focus();
                 showModalMessage("Your anonymous explanation helps build understanding. Please be constructive.");
            }
        }

        // Modal Logic
        const messageModal = document.getElementById('messageModal');
        const modalMessageText = document.getElementById('modalMessageText');

        function showModalMessage(message) {
            modalMessageText.textContent = message;
            messageModal.classList.remove('hidden');
        }

        function closeModal() {
            messageModal.classList.add('hidden');
        }


        // Initial setup
        showSection('profile', document.querySelector('nav a')); // Show profile by default
        // Initialize accordion icons correctly
        document.querySelectorAll('.accordion-content').forEach(content => {
            const icon = content.previousElementSibling.querySelector('.accordion-icon');
            if (content.classList.contains('hidden')) {
                icon.style.transform = 'rotate(0deg)';
            } else {
                icon.style.transform = 'rotate(180deg)';
            }
        });
    </script>
</body>
</html>
